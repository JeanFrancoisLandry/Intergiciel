

-- =============================================
-- Author:		JF Landry
-- Create date: 2019-11-25
-- Description:	Chargement initial des données brutes provenant de la table [ContenidoPAF]
-- =============================================
CREATE PROCEDURE [dbo].[sp_ChargementInitialBrutes_ContenidoPAF]

AS
BEGIN

	SET NOCOUNT ON;

	DECLARE @version as int,
			@Nom as varchar(50),
			@Description as varchar(100),
			@CompteRangeTable as int,
			@CreateDateTime	as datetime

	INSERT INTO [dbo].[Brute_ContenidoPAF]
     (
			 [Numero]
   			,[Version]
			,[Orden]
			,[SortOrder]
			,[IdPos]
			,[ParentIdPos]
			,[Parent1IdPos]
			,[Parent2IdPos]
			,[PhaseIdPos]
			,[PurchasesIdPos]
			,[Tipo]
			,[SubType]
			,[Nomenclatura]
			,[Concepto]
			,[Descripcion]
			,[Cantidad]
			,[CosteUnitario]
			,[PrecioUnitario]
			,[GoalUnitPrice]
			,[ManufacturerPrice]
			,[ResellerPrice]
			,[Descuento]
			,[Importe]
			,[AddWorkAmount]
			,[Beneficio]
			,[Color]
			,[Medidas]
			,[MakerId]
			,[WEBModelId]
			,[AltoDibujo]
			,[AnchoDibujo]
			,[FactorEscala]
			,[AltoCotas]
			,[Enviado]
			,[EnviadoG2]
			,[EnviadoG3]
			,[EnviadoG4]
			,[EnviadoG5]
			,[EnviadoG6]
			,[Facturado]
			,[FacturadoG2]
			,[FacturadoG3]
			,[FacturadoG4]
			,[FacturadoG5]
			,[FacturadoG6]
			,[Ventana]
			,[Varios]
			,[Persiana]
			,[Cuadros]
			,[Vidrios]
			,[Complementos]
			,[MOVentana]
			,[MOVarios]
			,[MOPersiana]
			,[MOCuadros]
			,[MOVidrios]
			,[MOComplementos]
			,[CosteVentana]
			,[CosteVarios]
			,[CostePersiana]
			,[CosteCuadros]
			,[CosteVidrios]
			,[CosteComplementos]
			,[CosteMOVentana]
			,[CosteMOVarios]
			,[CosteMOPersiana]
			,[CosteMOCuadros]
			,[CosteMOVidrios]
			,[CosteMOComplementos]
			,[VentanaReal]
			,[VariosReal]
			,[PersianaReal]
			,[CuadrosReal]
			,[VidriosReal]
			,[ComplementosReal]
			,[MOVentanaReal]
			,[MOVariosReal]
			,[MOPersianaReal]
			,[MOCuadrosReal]
			,[MOVidriosReal]
			,[MOComplementosReal]
			,[BOMCostPriceGroup1]
			,[BOMCostPriceGroup2]
			,[BOMCostPriceGroup3]
			,[BOMCostPriceGroup4]
			,[BOMCostPriceGroup5]
			,[BOMCostPriceGroup6]
			,[BOMCostLPriceGroup1]
			,[BOMCostLPriceGroup2]
			,[BOMCostLPriceGroup3]
			,[BOMCostLPriceGroup4]
			,[BOMCostLPriceGroup5]
			,[BOMCostLPriceGroup6]
			,[Texto]
			,[InternalRemarks]
			,[DesAuto]
			,[DesProd]
			,[DesG1]
			,[DesG2]
			,[DesG3]
			,[DesG4]
			,[DesG5]
			,[DesG6]
			,[ProdType]
			,[numMarcos]
			,[numHojas]
			,[numPostes]
			,[numInversoras]
			,[CajonPersiana]
			,[System]
			,[ProductType]
			,[Severity]
			,[PriceClosed]
			,[IsFiltered]
			,[XMLParam]
			,[NeedRecalculate]
			,[KeepPriceCoefficients]
			,[MaterialesPAFUTCModificationTime]
			,[ManoObraPAFUTCModificationTime]
			,[BackgroundUTCModificationTime]
			,[EditableJIT]
			,[NotPDEFactoryItem]
			,[PDEMasterData]
			,[FrozenForFactory]
			,[ForceFillDerivedPrices]
			,[CommodityCode]
			,[NatureOfTransaction]
			,[IntrastatQuantityUnits]
			,[IgnorePriceClosedInCost]
			,[EntityParentPublicPrice]

      )
    SELECT 
			 [Numero]
   			,[Version]
			,[Orden]
			,[SortOrder]
			,[IdPos]
			,[ParentIdPos]
			,[Parent1IdPos]
			,[Parent2IdPos]
			,[PhaseIdPos]
			,[PurchasesIdPos]
			,[Tipo]
			,[SubType]
			,[Nomenclatura]
			,[Concepto]
			,[Descripcion]
			,[Cantidad]
			,[CosteUnitario]
			,[PrecioUnitario]
			,[GoalUnitPrice]
			,[ManufacturerPrice]
			,[ResellerPrice]
			,[Descuento]
			,[Importe]
			,[AddWorkAmount]
			,[Beneficio]
			,[Color]
			,[Medidas]
			,[MakerId]
			,[WEBModelId]
			,[AltoDibujo]
			,[AnchoDibujo]
			,[FactorEscala]
			,[AltoCotas]
			,[Enviado]
			,[EnviadoG2]
			,[EnviadoG3]
			,[EnviadoG4]
			,[EnviadoG5]
			,[EnviadoG6]
			,[Facturado]
			,[FacturadoG2]
			,[FacturadoG3]
			,[FacturadoG4]
			,[FacturadoG5]
			,[FacturadoG6]
			,[Ventana]
			,[Varios]
			,[Persiana]
			,[Cuadros]
			,[Vidrios]
			,[Complementos]
			,[MOVentana]
			,[MOVarios]
			,[MOPersiana]
			,[MOCuadros]
			,[MOVidrios]
			,[MOComplementos]
			,[CosteVentana]
			,[CosteVarios]
			,[CostePersiana]
			,[CosteCuadros]
			,[CosteVidrios]
			,[CosteComplementos]
			,[CosteMOVentana]
			,[CosteMOVarios]
			,[CosteMOPersiana]
			,[CosteMOCuadros]
			,[CosteMOVidrios]
			,[CosteMOComplementos]
			,[VentanaReal]
			,[VariosReal]
			,[PersianaReal]
			,[CuadrosReal]
			,[VidriosReal]
			,[ComplementosReal]
			,[MOVentanaReal]
			,[MOVariosReal]
			,[MOPersianaReal]
			,[MOCuadrosReal]
			,[MOVidriosReal]
			,[MOComplementosReal]
			,[BOMCostPriceGroup1]
			,[BOMCostPriceGroup2]
			,[BOMCostPriceGroup3]
			,[BOMCostPriceGroup4]
			,[BOMCostPriceGroup5]
			,[BOMCostPriceGroup6]
			,[BOMCostLPriceGroup1]
			,[BOMCostLPriceGroup2]
			,[BOMCostLPriceGroup3]
			,[BOMCostLPriceGroup4]
			,[BOMCostLPriceGroup5]
			,[BOMCostLPriceGroup6]
			,[Texto]
			,[InternalRemarks]
			,[DesAuto]
			,[DesProd]
			,[DesG1]
			,[DesG2]
			,[DesG3]
			,[DesG4]
			,[DesG5]
			,[DesG6]
			,[ProdType]
			,[numMarcos]
			,[numHojas]
			,[numPostes]
			,[numInversoras]
			,[CajonPersiana]
			,[System]
			,[ProductType]
			,[Severity]
			,[PriceClosed]
			,[IsFiltered]
			,[XMLParam]
			,[NeedRecalculate]
			,[KeepPriceCoefficients]
			,[MaterialesPAFUTCModificationTime]
			,[ManoObraPAFUTCModificationTime]
			,[BackgroundUTCModificationTime]
			,[EditableJIT]
			,[NotPDEFactoryItem]
			,[PDEMasterData]
			,[FrozenForFactory]
			,[ForceFillDerivedPrices]
			,[CommodityCode]
			,[NatureOfTransaction]
			,[IntrastatQuantityUnits]
			,[IgnorePriceClosedInCost]
			,[EntityParentPublicPrice]
		FROM 
		OPENQUERY([PREFDB], 'SELECT 
					 [Numero]
   					,[Version]
					,[Orden]
					,[SortOrder]
					,[IdPos]
					,[ParentIdPos]
					,[Parent1IdPos]
					,[Parent2IdPos]
					,[PhaseIdPos]
					,[PurchasesIdPos]
					,[Tipo]
					,[SubType]
					,[Nomenclatura]
					,[Concepto]
					,[Descripcion]
					,[Cantidad]
					,[CosteUnitario]
					,[PrecioUnitario]
					,[GoalUnitPrice]
					,[ManufacturerPrice]
					,[ResellerPrice]
					,[Descuento]
					,[Importe]
					,[AddWorkAmount]
					,[Beneficio]
					,[Color]
					,[Medidas]
					,[MakerId]
					,[WEBModelId]
					,[AltoDibujo]
					,[AnchoDibujo]
					,[FactorEscala]
					,[AltoCotas]
					,[Enviado]
					,[EnviadoG2]
					,[EnviadoG3]
					,[EnviadoG4]
					,[EnviadoG5]
					,[EnviadoG6]
					,[Facturado]
					,[FacturadoG2]
					,[FacturadoG3]
					,[FacturadoG4]
					,[FacturadoG5]
					,[FacturadoG6]
					,[Ventana]
					,[Varios]
					,[Persiana]
					,[Cuadros]
					,[Vidrios]
					,[Complementos]
					,[MOVentana]
					,[MOVarios]
					,[MOPersiana]
					,[MOCuadros]
					,[MOVidrios]
					,[MOComplementos]
					,[CosteVentana]
					,[CosteVarios]
					,[CostePersiana]
					,[CosteCuadros]
					,[CosteVidrios]
					,[CosteComplementos]
					,[CosteMOVentana]
					,[CosteMOVarios]
					,[CosteMOPersiana]
					,[CosteMOCuadros]
					,[CosteMOVidrios]
					,[CosteMOComplementos]
					,[VentanaReal]
					,[VariosReal]
					,[PersianaReal]
					,[CuadrosReal]
					,[VidriosReal]
					,[ComplementosReal]
					,[MOVentanaReal]
					,[MOVariosReal]
					,[MOPersianaReal]
					,[MOCuadrosReal]
					,[MOVidriosReal]
					,[MOComplementosReal]
					,[BOMCostPriceGroup1]
					,[BOMCostPriceGroup2]
					,[BOMCostPriceGroup3]
					,[BOMCostPriceGroup4]
					,[BOMCostPriceGroup5]
					,[BOMCostPriceGroup6]
					,[BOMCostLPriceGroup1]
					,[BOMCostLPriceGroup2]
					,[BOMCostLPriceGroup3]
					,[BOMCostLPriceGroup4]
					,[BOMCostLPriceGroup5]
					,[BOMCostLPriceGroup6]
					,[Texto]
					,[InternalRemarks]
					,[DesAuto]
					,[DesProd]
					,[DesG1]
					,[DesG2]
					,[DesG3]
					,[DesG4]
					,[DesG5]
					,[DesG6]
					,[ProdType]
					,[numMarcos]
					,[numHojas]
					,[numPostes]
					,[numInversoras]
					,[CajonPersiana]
					,[System]
					,[ProductType]
					,[Severity]
					,[PriceClosed]
					,[IsFiltered]
					,[XMLParam]
					,[NeedRecalculate]
					,[KeepPriceCoefficients]
					,[MaterialesPAFUTCModificationTime]
					,[ManoObraPAFUTCModificationTime]
					,[BackgroundUTCModificationTime]
					,[EditableJIT]
					,[NotPDEFactoryItem]
					,[PDEMasterData]
					,[FrozenForFactory]
					,[ForceFillDerivedPrices]
					,[CommodityCode]
					,[NatureOfTransaction]
					,[IntrastatQuantityUnits]
					,[IgnorePriceClosedInCost]
					,[EntityParentPublicPrice]
		FROM [ADP_Prod].[dbo].[ContenidoPAF]')

	SET @version			= 1
	SET @Nom				= 'Brute_ContenidoPAF'
	SET @Description		= 'Chargement initial'
	SET @CompteRangeTable	= (SELECT COUNT(Numero) FROM [Prevost].[dbo].[Brute_ContenidoPAF])
	SET @CreateDateTime		= GETDATE()

	EXEC sp_Inserer_CompteTableIntergiciel @Version, @Nom, @Description, @CompteRangeTable, @CreateDateTime 

END
GO


